(function(){var p=NEJ.P("nej.p"),e=NEJ.P("nej.e"),j=NEJ.P("nej.j"),v=NEJ.P("nej.v"),u=NEJ.P("nej.u"),i=NEJ.P("nej.ui"),cg=NEJ.P("nec.g"),parseLibrary=window.parseLibrary,dfsRoot="/dfs",library,preHtml,html,postHtml,dependencies,css,combo,pageX,pageY,direction;function init(){initEventListener();initData();window.onresize=resize;resize();list();warm()}function initEventListener(){v.bp("run","click",onClickRun);v.bp("reset","click",onClickReset);v.bp("togglev","mousedown",function(s){direction="vertical";onMouseDown(s)});v.bp("togglev","drag",function(s){direction="vertical";onMouseDown(s)});v.bp("toolbar","dblclick",function(s){direction="vertical";onDblClick(s)});v.bp("toggleh","mousedown",function(s){direction="horizontal";onMouseDown(s)});v.bp("toggleh","drag",function(s){direction="horizontal";onMouseDown(s)});v.bp("toggleh","dblclick",function(s){direction="horizontal";onDblClick(s)})}function onClickRun(s){preview()}function onClickReset(){resetHtml();resetCss();preview()}function onMouseDown(s){showMask();v.bp(document,"mousemove",onMouseMove);v.bp(document,"touchmove",onMouseMove);v.bp(document,"mouseup",onMouseUp);v.bp(document,"touchend",onMouseUp)}function showMask(){var dy=e.Q("mask");if(!dy){dy=document.createElement("div");dy.id="mask";e.cR(dy,"m-mask");document.body.appendChild(dy)}dy.style.display=""}function hideMask(){var dy=e.Q("mask");if(dy)dy.style.display="none"}function resize(){if(navigator.appVersion.indexOf("MSIE 6")!=-1){var rM=e.Q("code").offsetHeight;e.Q("htmlSrc").style.height=rM+"px";e.Q("cssSrc").style.height=rM+"px"}}function onDblClick(s){if(direction=="vertical"){if(e.Q("code").style.height!="0%"){e.Q("code").style.height="0%";e.Q("preview").style.height="99.99%"}else{e.Q("code").style.height="";e.Q("preview").style.height=""}}else{e.Q("htmlCode").style.width="";e.Q("cssCode").style.width="";e.Q("cssCode").style.left="";e.Q("toggleh").style.left=""}}function onMouseMove(s){var lJ=getMousePosition(s),ck=document.documentElement||document.body,ho=e.Q("code");if(direction=="vertical"){var jA=0,jB=e.Q("workspace"),mS=e.Q("preview"),hm=document.getElementById("toolbar");var cI=lJ.y-jB.offsetTop,lO=jB.offsetHeight-jA;cI=cI<jA?jA:cI;cI=cI>lO?lO:cI;var lP=cI/jB.offsetHeight*100;mS.style.height=lP+"%";ho.style.height=99.99-lP+"%";resize()}else{var jC=100,jD=e.Q("htmlCode"),jE=e.Q("cssCode"),lT=e.Q("toggleh");var lU=jD.offsetLeft,lV=jE.offsetLeft-lT.offsetLeft,dO=lJ.x-jD.offsetLeft,lX=ho.offsetWidth-jC-lU-lV;dO=dO<jC?jC:dO;dO=dO>lX?lX:dO;jD.style.width=dO+"px";var lY=dO+lU,lZ=lY+lV,mR=ho.offsetWidth-lZ;lT.style.left=lY+"px";jE.style.left=lZ+"px";jE.style.width=mR+"px"}e.cR(document.body,"f-usn")}function getMousePosition(s){if(s.pageX)return{x:s.pageX,y:s.pageY};return{x:s.clientX+document.body.scrollLeft-document.body.clientLeft,y:s.clientY+document.body.scrollTop-document.body.clientTop}}function onMouseUp(s){hideMask();clearEvent();e.cX(document.body,"f-usn");v.iN(document,"mousemove",onMouseMove);v.iN(document,"touchmove",onMouseMove);v.iN(document,"mouseup",onMouseUp);v.iN(document,"touchend",onMouseUp)}function clearEvent(){v.da(document,"mousemove");v.da(document,"mousemup")}function resetHtml(){e.Q("htmlSrc").value=html}function resetCss(){e.Q("cssSrc").value=css}function initData(){library=parseLibrary(window.library);combo=new cg.ff(preview);combo.hh();j.ey(library.htmlsrc,{onload:onHtmlLoad});combo.hh();j.ey(library.csssrc,{onload:onCssLoad})}function onHtmlLoad(cD){var bB=cD.match(/([\s\S]*<body>\s*)([\s\S]*)(\s*<\/body>[\s\S]*)/);preHtml=bB[1].replace('<link rel="stylesheet" type="text/css" href="style.css"/>',"");html=bB[2];postHtml=bB[3];var mQ=/framework\/([^\.]+)\.css/g;while(mc=mQ.exec(preHtml)){if(mc[1]){dependencies=dependencies||[];dependencies.push(mc[1])}}var mP=/dfs\/([^\.]+)\/style\.css/g;while(me=mP.exec(preHtml)){if(me[1]){dependencies=dependencies||[];dependencies.push(me[1])}}if(dependencies&&dependencies.length){var jI=[];for(var i=0,fg;fg=dependencies[i];i++){if(/\d{6}\/\d{1}/.test(fg))jI.push('<a target="_blank" href="/library/'+fg+'">'+fg.split("/")[0]+"</a>");else jI.push('<a target="_blank" href="/framework/css-'+fg+'.html">'+fg+"</a>")}e.Q("introduction").innerHTML+="，依赖于"+jI.join("、")+"。"}resetHtml();combo.hi()}function onCssLoad(rT){css=rT;resetCss();combo.hi()}function preview(){var rT=e.Q("cssSrc").value,cD=e.Q("htmlSrc").value;rT=rT.replace(/url\(([^\)]+)\)/g,function(mN,ga){if(ga.indexOf("/")==-1){return"url(/dfs/"+library.name+"/"+version+"/"+ga+")"}return mN});var jQ=e.Q("previewIframe").contentWindow.document;jQ.open();jQ.write(preHtml+cD+postHtml);jQ.close();var fZ=jQ.createElement("style");rT="html{_overflow-y:scroll;}"+rT;var mj=document.createTextNode(rT);fZ.type="text/css";var rN=jQ.getElementsByTagName("head")[0].getElementsByTagName("style")[0];if(rN){jQ.getElementsByTagName("head")[0].insertBefore(fZ,rN)}else{jQ.getElementsByTagName("head")[0].appendChild(fZ)}if(fZ.styleSheet)fZ.styleSheet.cssText=mj.nodeValue;else fZ.appendChild(mj)}function list(){var rO=libraryList.length;var mN="";if(rO>1){var rP=e.Q("more");var M=e.Q("list");for(var i=0;i<rO;i++){if(libraryList[i].name!=library.name){mN+='<a href="/library/'+libraryList[i].name+'"><b>'+libraryList[i].title+"</b></a>"}}M.innerHTML=mN;rP.className="more";rP.onclick=function(e){if(e&&e.stopPropagation){e.stopPropagation()}else{window.event.cancelBubble=true}if(M.style.display=="none"){M.style.display=""}else{M.style.display="none"}};document.body.onclick=function(){M.style.display="none"}}}function warm(){if(version!=3)return;var rR=function(){var rQ=document.createElement("div"),cG="webkit,moz,ms,o".split(","),kQ=cG.length;return function(pt){if(pt in rQ.style)return true;eG=pt.replace(/^[a-z]/,function(str){return str.toUpperCase()});while(kQ--){if(cG[kQ]+eG in rQ.style){return true}}return false}}();if(rR("animation"))return;var qw=document.createElement("span");qw.className="warm";qw.innerText="您的浏览器可能看不到正确效果";e.Q("js-tlt").appendChild(qw)}init()})()